<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic Page Loader</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; background-color: #111; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #msg { text-align: center; line-height: 1.6; }
    </style>
</head>
<body>
    <div id="msg">
        <h2>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</h2>
        <p style="font-size: 0.8rem; color: #888;">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
    </div>

    <script>
        // ë„¤ê°€ ì œê³µí•œ êµ¬ê¸€ ì‹œíŠ¸ CSV ë§í¬ (ê·¸ëŒ€ë¡œ ë‘ë©´ ë¨)
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSMlEIGB8fdhMG_z_wOU6K7hqEUfYRqG3tTv8V5ma-lbxi-NYQbzi2Im2HtcN2mBk1ER4FYVY_NAd6t/pub?gid=0&single=true&output=csv"; 

        // ì£¼ì†Œì°½ì—ì„œ ?id=ê°’ ê°€ì ¸ì˜¤ê¸°
        const params = new URLSearchParams(window.location.search);
        const targetId = params.get('id');

        if (!targetId) {
            document.getElementById('msg').innerHTML = "<h1>ì ‘ì† ì˜¤ë¥˜</h1><p>ì£¼ì†Œ ë’¤ì— <code>?id=ì´ë¦„</code>ì„ ë¶™ì—¬ì£¼ì„¸ìš”.<br>ì˜ˆ: /?id=subway</p>";
        } else {
            Papa.parse(SHEET_URL, {
                download: true,
                header: true, // 1í–‰(id, raw_code, html)ì„ ì œëª©ìœ¼ë¡œ ì¸ì‹
                skipEmptyLines: true, // ë¹ˆ ì¤„ ë¬´ì‹œ
                complete: function(results) {
                    const data = results.data;
                    // idê°€ ì¼ì¹˜í•˜ëŠ” í–‰ ì°¾ê¸°
                    const found = data.find(row => row.id === targetId);

                    if (found) {
                        // Cì—´(html)ì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
                        if (found.html && found.html.trim() !== "") {
                            // ì°¾ì•˜ìœ¼ë©´ í˜„ì¬ í™”ë©´ì„ ì‹¹ ì§€ìš°ê³  ë³€í™˜ëœ HTMLë¡œ ë®ì–´ì“°ê¸°
                            document.open();
                            document.write(found.html);
                            document.close();
                        } else {
                            document.getElementById('msg').innerHTML = `
                                <h2>ë³€í™˜ëœ ì½”ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</h2>
                                <p>IDëŠ” ì°¾ì•˜ì§€ë§Œ, ë³€í™˜ëœ HTML(Cì—´)ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.<br>
                                êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ <b>[ğŸš€ ì‚¬ì´íŠ¸ ë°°í¬ ë²„íŠ¼]</b>ë¥¼ ëŒë ¤ì£¼ì„¸ìš”!</p>`;
                        }
                    } else {
                        document.getElementById('msg').innerHTML = `<h2>IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h2><p>ì…ë ¥í•œ ID: <b>${targetId}</b><br>êµ¬ê¸€ ì‹œíŠ¸ Aì—´ì— ì´ IDê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</p>`;
                    }
                },
                error: function(err) {
                    console.error(err);
                    document.getElementById('msg').innerText = "êµ¬ê¸€ ì‹œíŠ¸ ì—°ê²° ì‹¤íŒ¨. ì¸í„°ë„· ìƒíƒœë‚˜ ë§í¬ë¥¼ í™•ì¸í•˜ì„¸ìš”.";
                }
            });
        }
    </script>
</body>
</html>
